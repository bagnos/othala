<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="it.othala.product.queries">



	<select id="listProduct" resultType="it.othala.dto.ProductDTO"
		parameterType="java.util.HashMap">

		SELECT a.idProduct ,
		imPrice as price,
		txDescription as description,
		pcDiscount as discount
		FROM
		${database.schema}product a,
		${database.schema}product_description b
		where a.idProduct = b.idProduct
		and b.idLanguages = #{languages}
	</select>

	<select id="listArticleAttribute" resultType="String"
		parameterType="java.util.HashMap">

		SELECT txValore FROM ${database.schema}article_attribute
		a,
		${database.schema}attribute b,
		${database.schema}valori_attributo c,
		${database.schema}valori_attributo_languages d
		where
		a.idProductAttribute = b.idProductAttribute
		and a.idProductAttribute =
		c.idProductAttribute
		and a.pgProductAttribute = c.pgProductAttribute
		and a.idProductAttribute = d.idProductAttribute
		and
		a.pgProductAttribute = d.pgProductAttribute
		and idProduct =
		#{idProduct}
		and a.idProductAttribute = #{idProductAttribute}
		and
		d.idLanguages = #{languages}

	</select>

	<select id="getProductAttribute" resultType="String"
		parameterType="java.util.HashMap">

		SELECT txValore FROM ${database.schema}product_attribute
		a,
		${database.schema}product b,
		${database.schema}attribute e,
		${database.schema}valori_attributo c,
		${database.schema}valori_attributo_languages d
		where a.idProduct =
		b.idProduct
		and a.idProductAttribute = c.idProductAttribute
		and
		a.pgProductAttribute = c.pgProductAttribute
		and a.idProductAttribute =
		d.idProductAttribute
		and a.pgProductAttribute = d.pgProductAttribute
		and a.idProduct = #{idProduct}
		and d.idLanguages = #{languages}
		and
		a.idProductAttribute = #{idProductAttribute}
		and e.idLanguages =
		d.idLanguages
		and e.idProductAttribute = a.idProductAttribute

	</select>
	
		<select id="listProductAttribute" resultType="it.othala.dto.AttributeDTO"
		parameterType="java.util.HashMap">

		SELECT a.idProductAttribute as attributo,txValore as valore  
		FROM ${database.schema}product_attribute a,
		${database.schema}product b,
		${database.schema}attribute e,
		${database.schema}valori_attributo c,
		${database.schema}valori_attributo_languages d
		where a.idProduct =
		b.idProduct
		and a.idProductAttribute = c.idProductAttribute
		and
		a.pgProductAttribute = c.pgProductAttribute
		and a.idProductAttribute =
		d.idProductAttribute
		and a.pgProductAttribute = d.pgProductAttribute
		and a.idProduct = #{idProduct}
		and d.idLanguages = #{languages}
		and e.idLanguages =
		d.idLanguages
		and e.idProductAttribute = a.idProductAttribute

	</select>

	<select id="listProductImages" resultType="String"
		parameterType="java.util.HashMap">

		SELECT txImageUrl FROM ${database.schema}product_image
		where
		idProduct = #{idProduct}

	</select>

</mapper>